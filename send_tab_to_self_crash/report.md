# Summary

When a tab is created, then moved to a different window, the browser will crash when the "send tab to self" icon is clicked in the omnibox, due to what appears to be a use-after-free.

# Description

As stated in the summary, this appears to be a use-after-free. The reasoning for that is as follows:

If a tab is created and moved to a different window, but the original window is kept open, the browser won't crash when clicking the "send tab to self" icon. You can test that by going through the following steps:

1. Create a new tab.
2. Move the tab to a new window. Ensure the original window stays open.
3. In the omnibox for the tab, click the "send tab to self" icon. The browser won't crash and the "send tab to self" bubble will be shown. However, it will be shown within the original window, rather than the window the tab was moved to.

This is in contrast to what happens when the original window is closed. You can test that case by going through the following steps:

1. Create a new tab.
2. Move the tab to a new window.
3. Close the original window.
4. In the omnibox for the tab, click the "send tab to self" icon. This time, the browser will crash, possibly because it's attempting to refer to an object associated with the original window. This is what's demonstrated using the extension that's attached.

Finally, the "send tab to self" icon only appears in the omnibox from the dev channel onwards, so that's what should be used for testing.

## Steps to Reproduce

1. Install the attached extension.
2. Once installed, the extension will create a tab, then move the tab to a new window.
3. Once that's happened, click the "send tab to self" icon shown in the omnibox. This should cause the browser to crash, due to a possible use-after-free.