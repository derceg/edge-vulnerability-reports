startProcess();

function startProcess() {
    chrome.windows.create({focused: true}, function (newWindow) {
        setTimeout(() => {
            removeWindow(newWindow);
        }, 5000);
    });
}

function removeWindow(newWindow) {
    chrome.windows.remove(newWindow.id);

    chrome.windows.onRemoved.addListener(function windowRemovedListener(windowId) {
        if (windowId === newWindow.id) {
            chrome.windows.onRemoved.removeListener(windowRemovedListener);

            chrome.browserAction.setBadgeText({text: Math.random().toString()});
        }
    });
}